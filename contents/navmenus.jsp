<%@ page errorPage="/errors/ExceptionPage.jsp" %><%@ page import="java.sql.*,com.marcomet.tools.*,com.marcomet.environment.*,com.marcomet.users.security.*,com.marcomet.jdbc.*;" %><jsp:useBean id="str" class="com.marcomet.tools.StringTool" scope="session" /><%Connection conn = DBConnect.getConnection();Statement st = conn.createStatement();boolean regionFlag=((request.getParameter("regionFlag")==null || request.getParameter("regionFlag").equals("true"))?true:false);String regionId=((regionFlag)?((request.getParameter("regionId")==null)?"":request.getParameter("regionId")):"");String regionIdStr=((regionId.equals("1") || regionId.equals(""))?"":"regionId="+request.getParameter("regionId"));String regionName="";if (regionId.equals("") || regionId.equals("1")){	%><%}else{	ResultSet rsRg = st.executeQuery("select * from roc_regions where id='"+regionId+"'");	if (rsRg.next()){		regionName=rsRg.getString("name");	}}boolean editorRole=((((RoleResolver)session.getAttribute("roles")).roleCheck("editor")) || (((RoleResolver)session.getAttribute("roles")).roleCheck("ROC_editor")));boolean editor=((session.getAttribute("editorOff")!=null && session.getAttribute("editorOff").equals("true"))?false:editorRole);String ShowRelease=((request.getParameter("ShowRelease")==null || request.getParameter("ShowRelease").equals("")) ? "":" AND release='"+request.getParameter("ShowRelease")+"' ");boolean showHelp=((request.getParameter("showHelp")==null || request.getParameter("showHelp").equals("false")) ?false:true);String ShowInactive=((request.getParameter("ShowInactive")==null || request.getParameter("ShowInactive").equals(""))?" AND status_id=2 ":""); String navTitle=((request.getParameter("navTitle")==null || request.getParameter("navTitle").equals(""))?"Additional Links...":request.getParameter("navTitle")); String navSubTitle=((request.getParameter("navSubTitle")==null || request.getParameter("navSubTitle").equals(""))?"":request.getParameter("navSubTitle")); String pageName=((request.getParameter("pageName")==null || request.getParameter("pageName").equals(""))?" AND n.page_name='xxx' ":" AND n.page_name= '"+request.getParameter("pageName")+"' "); String sitehostId=((SiteHostSettings)session.getAttribute("siteHostSettings")).getSiteHostId();String nSQL="SELECT  n.id,n.link,n.link_text,n.target,n.link_page,n.prodline_id,nh.title,nh.subtitle FROM nav_menus n left join nav_menu_headers nh on n.page_name=nh.page_name where sitehost_id="+sitehostId+pageName+ShowInactive+ShowRelease+" ORDER BY sequence";ResultSet rs = st.executeQuery(nSQL); int x=1;int y=1;while(rs.next()){	navTitle=((rs.getString("title")==null)?navTitle:rs.getString("title"));	navSubTitle=str.replaceSubstring( ((rs.getString("subtitle")==null)?navSubTitle:rs.getString("subtitle")),"|region|",(regionName.equals(""))?"":"Region:&nbsp:"+regionName);	if (x==1){	%><table border=0 cellpadding=0 cellspacing=0 width="100%">	<tr><td valign="top"><table align="top" cellpadding=0 cellspacing=0 width=100%>			<tr><td width=100% class="leftNavBarHeader"><%=navTitle%><%=((navSubTitle==null || navSubTitle.equals(""))?"":"<br>&nbsp;&nbsp;"+navSubTitle)%></td></tr>			<tr><td>				<table id="subMenu0" width=100% cellspacing=0 cellpadding=0><%		}	String link=str.replaceSubstring(rs.getString("link"),"SHD",(String)session.getAttribute("siteHostRoot"))+((regionIdStr.equals(""))?"":((rs.getString("link").indexOf("?")>-1)?"&"+regionIdStr:"?"+regionIdStr));	link=link+((rs.getString("link").indexOf("?")>-1)?"&menuId="+rs.getString("id"):"?menuId="+rs.getString("id"));	String target=((rs.getString("target").equals(""))?"main":rs.getString("target"));		%><tr>			<td class="leftNavBarItem2" onMouseOver="this.className='leftNavBarItemOver2';cmslnk<%=rs.getString("id")%>.className='leftNavBarItemHover2'" onMouseOut="this.className='leftNavBarItem2';cmslnk<%=rs.getString("id")%>.className='leftNavBarItem2'" height="30"><%if (editor){%><a href='javascript:pop("/popups/QuickChangeForm.jsp?cols=60&rows=2&question=Change%20Navigation%20Menu%20Text&primaryKeyValue=<%=rs.getString("id")%>&columnName=link_text&tableName=nav_menus&valueType=string",500,100)'>&raquo;</a>&nbsp;<%}%><a href="<%=link%>" class='leftNavBarItem2' id='cmslnk<%=rs.getString("id")%>' target='<%=target%>'><%=rs.getString("link_text")%></a></td></tr><%	y++;	x++;	}	if (showHelp){		%><tr><td class="leftNavBarBottom" onMouseOver="this.className='leftNavBarBottomOver';cmslnk<%=y%>.className='leftNavBarBottomTextOver'" onMouseOut="this.className='leftNavBarBottom';cmslnk<%=y%>.className='leftNavBarBottomText'" height="30"><a href="javascript:pop('/popups/help.jsp','650','550')" id='cmslnk<%=y%>' class='leftNavBarBottomText'>Need Help? Click here... </a></td></tr><%     }if (rs  != null)	rs.close();	st.close();     %></table></td></tr></table>