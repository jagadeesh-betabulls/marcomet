<%@ page import="com.marcomet.tools.*,com.marcomet.environment.*;" %><%@ include file="/includes/SessionChecker.jsp" %><%@ taglib uri="/WEB-INF/tld/formTagLib.tld" prefix="formtaglib" %><%@ taglib uri="/WEB-INF/tld/taglib.tld" prefix="taglib" %><%String siteHostT = session.getAttribute("siteHostRoot").toString();SiteHostSettings shs = (SiteHostSettings)session.getAttribute("siteHostSettings");String siteHostId = shs.getSiteHostId();String siteHost = siteHostT.substring(11,siteHostT.length());String vendorId=session.getAttribute("companyId").toString();String sql="select distinct c.id 'value',concat(if(c.default_site_number is null or c.default_site_number=0,if(left(company_name,1)=1 or left(company_name,1)=3 or left(company_name,1)=7,concat('Site:',co.company_name),co.company_name),concat('Site:',c.default_site_number,(if(co.company_name=c.default_site_number,'',concat(' - ',co.company_name))))),', Id #',c.id) 'text'  from companies co,contacts c,contact_roles l,site_hosts sh where l.contact_id=c.id and l.site_host_id=sh.id and sh.sitehost_client_id = '"+siteHostId+"'  and co.company_name<>'' and co.id=c.companyid group by co.id order by text";String siteChoiceSql="select id 'value',site_name 'text' from site_hosts where sitehost_client_id="+siteHostId;%><html><head><META HTTP-EQUIV="pragma" CONTENT="no-cache"><META HTTP-EQUIV="Pragma-directive" CONTENT="no-cache"><META HTTP-EQUIV="cache-directive" CONTENT="no-cache"><title>History Report Filters</title><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><link rel="stylesheet" href="<%=(String)session.getAttribute("siteHostRoot")%>/styles/vendor_styles.css" type="text/css"><link rel="stylesheet" href="/javascripts/jscalendar/calendar-win2k-1.css" type="text/css"><script type="text/javascript" src="/javascripts/jscalendar/calendar.js"></script><script type="text/javascript" src="/javascripts/jscalendar/lang/calendar-en.js"></script><script type="text/javascript" src="/javascripts/jscalendar/calendar-setup.js"></script></head><script language="JavaScript" src="/javascripts/mainlib.js"></script><script language="JavaScript">function submitForm(){	document.getElementById('loading').innerHTML=" C R E A T I N G&nbsp;&nbsp;&nbsp;R E P O R T . . .<br><br><img src=\"/images/loading.gif\">";	document.forms[0].action=((document.forms[0].showCustomer.checked==false && document.forms[0].buyerCompany.value=='0' && document.forms[0].showAllCustomers.checked==true )?"/reports/sitehostmanager/orderHistoryAllCompanies.jsp":((document.forms[0].showCustomer.checked==true && document.forms[0].buyerCompany.value=='0' && document.forms[0].showAllCustomers.checked==true )?"/reports/sitehostmanager/orderHistoryAllCompaniesWithTotals.jsp":((document.forms[0].showCustomer.checked==true && document.forms[0].buyerCompany.value=='0' && document.forms[0].showAllCustomers.checked==false )?"/reports/sitehostmanager/orderHistoryWithTotals.jsp":"/reports/sitehostmanager/orderHistory.jsp")));	document.forms[0].submit();}</script>	<body bgcolor="#FFFFFF" text="#000000" style="margin-left: 100px;	margin-right: 100px;"><div id='loading' align='center' style="float:right;"> L O A D I N G . . .<br><br><img src='/images/loading.gif'></div><form method="post" action="/reports/sitehostmanager/orderHistory.jsp">  <div class="Title">Site Management Report Console</div><div class="subtitle">Order History Report Generator</div><input type="hidden" name="vendorId" value="<%=vendorId%>">  <p></p>  <p>&nbsp;</p><table border=0 align='center'><tr><td class='lineitems' style="width:450px;">&nbsp;&nbsp;Report Type:<br /><input type='radio' checked name="reportType" value='1'>By Date | <input type='radio' name="reportType" value='2'>By Root Product</td></tr><td class='lineitems' style="width:450px;"><br />&nbsp;&nbsp;Order Date From:&nbsp;<input type="hidden" name="dateFrom" id="f_datefrom_d"><span class="lineitemsselected" id="show_d"></span>&nbsp;<img src="/javascripts/jscalendar/img.gif" align="absmiddle" id="f_trigger_c"				     style="cursor: pointer; border: 1px solid red;"				     title="Date selector"				     onmouseover="this.style.background='red';"				     onmouseout="this.style.background=''" />					<script type="text/javascript">					    Calendar.setup({					        inputField     :    "f_datefrom_d",					        ifFormat       :    "%Y-%m-%d",					        displayArea    :    "show_d",					        daFormat       :    "%m-%d-%Y",					        button         :    "f_trigger_c",					        align          :    "BR",					        singleClick    :    true					    });						var d=new Date();						document.forms[0].dateFrom.value=d.getFullYear()+"-01-01";document.getElementById('show_d').innerHTML="01-01-"+d.getFullYear();					</script>				&nbsp;--&nbsp;Date To:&nbsp;</span>					<input type="hidden" name="dateTo" id="f_dateto_d">					<span class="lineitemsselected" id="show_dt"></span>&nbsp;<img src="/javascripts/jscalendar/img.gif" align="absmiddle" id="f_trigger_c2"							     style="cursor: pointer; border: 1px solid red;"							     title="Date selector"							     onmouseover="this.style.background='red';"							     onmouseout="this.style.background=''" />								<script type="text/javascript">								    Calendar.setup({								        inputField     :    "f_dateto_d",								        ifFormat       :    "%Y-%m-%d",								        displayArea    :    "show_dt",								        daFormat       :    "%m-%d-%Y",								        button         :    "f_trigger_c2",								        align          :    "BR",								        singleClick    :    true								    });									var d=new Date()									document.forms[0].dateTo.value=d.getFullYear()+"-"+ (d.getMonth()+1)+"-"+d.getDate();									document.getElementById('show_dt').innerHTML=(d.getMonth()+1)+"-"+d.getDate()+"-"+d.getFullYear();								</script>								</td></tr>     <td class='lineitems' style="width:450px;"><br /><input type='checkbox' name="showInvoices" value='1' checked>Show Billed Jobs Only <br><input type='checkbox' name="showCustomer" value='1'>Show Property Site Totals | <input type='checkbox' name="showAllCustomers" value='1'>Include Property Sites with No Orders<br />- OR -<br />&nbsp;&nbsp;Choose Buyer Company:&nbsp;      <formtaglib:SQLDropDownTag dropDownName="buyerCompany" sql="<%=sql%>" extraCode="class=\"lineitems\" onChange=\"document.forms[0].buyerCompanyText.value=this.options[this.selectedIndex].text\"" extraFirstOption="<option value=\"0\">All</option>" /><br>Choose Site:<formtaglib:SQLDropDownTag dropDownName="siteChoice" sql="<%=siteChoiceSql%>" extraCode="class=\"lineitems\" onChange=\"document.forms[0].sitehostText.value=this.options[this.selectedIndex].text;document.forms[0].sitehostChoiceId.value=this.value\"" extraFirstOption="<option value=\"0\">All</option>" /></td></tr><tr><td><div align='center'><a href="#" class='menuLINK' onClick="history.go(-1)">Cancel</a>&nbsp;&nbsp;<a href="#" class='menuLINK' onClick="submitForm()">Generate Report</a></div></td></tr></table><input type="hidden" name="buyerCompanyText" value=""><input type="hidden" name="sitehostText" value="All"><input type="hidden" name="sitehostChoiceId" value=""><input type="hidden" name="siteHost" value="<%=siteHost%>"><input type="hidden" name="siteHostId" value="<%=siteHostId%>"></form><script>	document.getElementById('loading').innerHTML='';	</script></body></html>